<!DOCTYPE html>
<html lang="es" xmlns:th="https://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>
    <meta charset="UTF-8">
    <title>Dashboard POS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Icono de pestaña -->
    <link rel="icon" type="image/png" th:href="@{/img/stella.jpg}">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Select2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <!-- Select2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=account_circle" />

    <!-- BS Icons: -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <!-- BS -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous"> -->

    <link rel="stylesheet" href="/css/style.css">

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet">

    <link rel="stylesheet" href="/css/layout-dash-css.css">
</head>

<body>
    <div class="d-flex">
        <!-- Sidebar -->


        <nav class="text-white p-3" style="width:230px; min-height: 100vh; height: auto;">
            <h4 class="mb-4 fw-bold">Administración</h4>
            <ul class="nav flex-column">
                <li class="nav-item rounded"><a th:href="@{/dashboard}" class="nav-link text-white">Dashboard</a></li>
                <li class="nav-item"><a th:href="@{/productos/listadoAdmin}" class="nav-link text-white">Productos</a>
                </li>
                <li class="nav-item"><a href="#" class="nav-link text-white">Categorías</a></li>
                <li class="nav-item"><a th:href="@{/ofertas/listadoAdmin}" class="nav-link text-white">Ofertas</a></li>
                <li class="nav-item"><a th:href="@{/usuarios/listadoAdmin}" class="nav-link text-white">Usuarios</a>
                </li>
                <li class="nav-item"><a th:href="@{/proveedores/listar}" class="nav-link text-white">Proveedores</a>
                </li>
                <li class="nav-item"><a th:href="@{/ventas/nuevo}" class="nav-link text-white">Ventas</a></li>
                <li class="nav-item"><a th:href="@{/ventas/listadoAdmin}" class="nav-link text-white">Listado de
                        Ventas</a></li>
                <li class="nav-item"><a th:href="@{/reportes}" class="nav-link text-white">Reportes</a></li>
                <li class="nav-item"><a th:href="@{/cajas/listadoAdmin}" class="nav-link text-white">Cajas</a></li>
                <!-- <li class="nav-item"><a href="#" class="nav-link text-white">Configuración</a></li> -->
                <li class="nav-item"><a th:href="@{/}" class="nav-link text-white">Stella</a></li>
                <form id="frmSalir" th:action="@{/logout}" method="post" class="mt-5">
                    <a id="salir" class="dropdown-item" href="#" onclick="$('#frmSalir').submit();">Cerrar
                        Sesión</a>
                </form>
            </ul>
        </nav>

        <div id="hijo" class="flex-grow-1 p-4">
            <!-- Mensajes -->
            <!-- Mensaje al habilitar/deshabilitar productos con Bootstrap -->
            <div class="alert alert-info alert-dismissible fade show" role="alert" th:if="${info != null}">
                <i class='bx bx-info-circle bx-tada'></i>
                &nbsp;
                <span th:text="${info}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
            </div>
            <!-- Mensaje al añadir productos -->
            <div class="alert alert-success alert-dismissible fade show" role="alert" th:if="${success != null}">
                <i class='bx bx-check-double bx-tada'></i>
                &nbsp;
                <span th:text="${success}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
            </div>
            <!-- Mensaje al Editar un producto -->
            <div class="alert alert-warning alert-dismissible fade show" role="alert" th:if="${warning != null}">
                <i class='bx bx-message-rounded-dots bx-tada'></i>
                &nbsp;
                <span th:text="${warning}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
            </div>
            <!-- Mensaje al borrar un producto -->
            <div class="alert alert-danger alert-dismissible fade show" role="alert" th:if="${danger != null}">
                <i class='bx bx-error-circle bx-tada'></i>
                &nbsp;
                <span th:text="${danger}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
            </div>
            <!-- Modal de confirmación -->
            <div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header bg-danger text-white">
                            <h5 class="modal-title" id="confirmDeleteModalLabel">Confirmar borrado</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                aria-label="Cerrar"></button>
                        </div>
                        <div class="modal-body">
                            <p th:text="${tipo}"></p>
                            <!-- ¿Estás seguro que quieres borrar este producto? Esta acción no se puede deshacer. -->
                            <!-- O se puede preguntar lo que quieras hacer antes de confirmar la acción -->
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <a id="btnConfirmDelete" href="#" class="btn btn-danger">Borrar</a>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Fragment -->
            <div layout:fragment="dashboard">

            </div>
        </div>
    </div>

    <!-- Para que se cierren los Alert Bootstrap -->
    <script>

        // Ejecuta cada 3 segundos, pero sin romper si no hay alertas xd
        setInterval(() => {
            const alertas = $(".alert");
            if (alertas && alertas.length > 0) {
                alertas.delay(500).slideUp(500, function () {
                    $(this).hide();
                });
            }
        }, 3000);
    </script>

    </script>

    <script>
        $(document).ready(function () {
            $('#productos').select2({
                placeholder: "Escribe para buscar productos",
                allowClear: true,
                width: 'resolve'
            });
        });
    </script>

    <!-- Para que funcione la ventana modal de confirmar borrar -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const deleteButtons = document.querySelectorAll(".btn-delete");
            const confirmModal = new bootstrap.Modal(document.getElementById("confirmDeleteModal"));
            const confirmBtn = document.getElementById("btnConfirmDelete");

            deleteButtons.forEach(btn => {
                btn.addEventListener("click", function (e) {
                    e.preventDefault(); // Evita la redirección inmediata
                    const href = this.getAttribute("data-href");
                    confirmBtn.setAttribute("href", href);
                    confirmModal.show();
                });
            });
        });
    </script>
    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

    <script th:replace="~{:: js}"></script>
    <!-- Esto hace, que en otras paginas se herede estos JS, ademas de agregar el nuestro para esa pag -->
</body>

</html>